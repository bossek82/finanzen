<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rentenlücke</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="rentenluecke-header">
        <h1>Persönliche Rentensituation berechnen</h1>
    </div>
    
    
    <form id="rentenluecke-form">
        <fieldset>
            <legend>Aktuelle Einnahmen/Ausgaben</legend>
            <label for="nettoeinkommen">Nettoeinkommen aktuell (€):</label>
            <input type="number" id="nettoeinkommen" name="nettoeinkommen" value="2500" step="100" required><br>

            <label for="gehaltswachstum">Gehaltswachstum (% pro Jahr):</label>
            <input type="number" id="gehaltswachstum" name="gehaltswachstum" value="1.5" step="0.1" required><br>

            <label for="entfallende-ausgaben">Aktuelle Ausgaben, die in der Rente entfallen, z.B. Kredit (€):</label>
            <input type="number" id="entfallende-ausgaben" name="entfallende-ausgaben" value="1500" step="100" required><br>
        </fieldset>

        <fieldset>
            <legend>Vermögen und Vermögensaufbau</legend>
            <label for="sparruecklage">Monatliche Sparrücklage (€):</label>
            <input type="number" id="sparruecklage" name="sparruecklage" value="100" step="50" required><br>

            <label for="kapital">Vorhandenes Vermögen (€):</label>
            <input type="number" id="kapital" name="kapital" value="50000" step="1000" required><br>

            <label for="zinssatz">Jährlicher Zinssatz auf Vermögen (%):</label>
            <input type="number" id="zinssatz" name="zinssatz" value="6" step="0.1" required><br>
        </fieldset>
        <fieldset>
            <legend>Renteinformationen</legend>
            <label for="jahre-bis-rente">Jahre bis zur Rente:</label>
            <input type="number" id="jahre-bis-rente" name="jahre-bis-rente" value="25" step="1" required><br>

            <label for="geschaetzte-rente">Geschätzte monatliche Netto-Rente (€):</label>
            <input type="number" id="geschaetzte-rente" name="geschaetzte-rente" value="1000" step="50" required><br>

            <label for="rentenentwicklung">Jährliche Rentenentwicklung (%):</label>
            <input type="number" id="rentenentwicklung" name="rentenentwicklung" value="1" step="0.1" required><br>

            <label for="jahre-ab-rente">Jahre ab Rente bis zum Tod:</label>
            <input type="number" id="jahre-ab-rente" name="jahre-ab-rente" value="25" step="1" required><br>

            <label for="zusatzvermoegen">Netto Zusatzvermögen ab Renteneintritt, z.B. Auszahlung Betriebsrente (€):</label>
            <input type="number" id="zusatzvermoegen" name="zusatzvermoegen" value="100000" step="1000" required><br>
        </fieldset>

        <label for="inflation">Jährliche Inflation (%):</label>
        <input type="number" id="inflation" name="inflation" value="2" step="0.1" required><br>

        <button type="button" id="berechnen-button">Berechnen</button>
        <script>
            document.getElementById('berechnen-button').onclick = function () {
            // Reset all result fields before calculation
            const fieldsToReset = [
                'nettoeinkommen-am-anfang',
                'vermoegen-am-anfang-rente',
                'nettoeinkommen-bei-rente',
                'lebensstandard-am-anfang',
                'lebensstandard-bei-rente',
                'vermoegen-am-anfang',
                'vermoegen-bei-rente',
                'netto-gespart',
                'zinsvermoegen',
                'lebensstandard-ab-rente',
                'geschaetzte-rente-ab-rente',
                'lebensstandard-bei-tod',
                'rente-bei-tod',
                'delta-am-anfang-rente',
                'delta-bei-tod',
                'vermoegen-bei-tod',
                'vermoegen-ohne-entnahme-bei-tod',
                'entnommenes-vermoegen',
                'delta-pro-jahr',
                'zusatzvermoegen-am-anfang-rente',
                'vermoegen-am-anfang-rente-ohne-zusatz'
            ];

            fieldsToReset.forEach(fieldId => {
                const element = document.getElementById(fieldId);
                if (element) {
                    element.textContent = '';
                }
            });
            };
        </script>
    </form>




    
    <div id="berechnete-werte-bis-rente">
        <h2>Monatlicher Bedarf bis Renteneintritt</h2>
        <canvas id="nettoeinkommen-graph"></canvas>
        <div id="berechnete-ergebnisse">
            <p id="nettoeinkommen-am-anfang"></p>
            <p id="nettoeinkommen-bei-rente"></p>
            <p id="lebensstandard-am-anfang"></p>
            <p id="lebensstandard-bei-rente"></p>
        </div>
        <script>
            document.getElementById('berechnen-button').addEventListener('click', function () {
                const nettoeinkommen = parseFloat(document.getElementById('nettoeinkommen').value);
                const gehaltswachstum = parseFloat(document.getElementById('gehaltswachstum').value) / 100;
                const jahreBisRente = parseInt(document.getElementById('jahre-bis-rente').value);
                const entfallendeAusgaben = parseFloat(document.getElementById('entfallende-ausgaben').value);
                const sparruecklage = parseFloat(document.getElementById('sparruecklage').value);

                const nettoeinkommenJahre = [];
                const lebensstandardJahre = [];
                const sparruecklageJahre = [];
                const entfallendeAusgabenJahre = [];
                let aktuellesEinkommen = nettoeinkommen;

                for (let jahr = 0; jahr <= jahreBisRente; jahr++) {
                    nettoeinkommenJahre.push({ jahr, einkommen: aktuellesEinkommen });
                    const lebensstandard = aktuellesEinkommen - entfallendeAusgaben - sparruecklage;
                    lebensstandardJahre.push({ jahr, lebensstandard });
                    sparruecklageJahre.push({ jahr, sparruecklage });
                    entfallendeAusgabenJahre.push({ jahr, entfallendeAusgaben });
                    aktuellesEinkommen += aktuellesEinkommen * gehaltswachstum;
                }

                const nettoeinkommenAmAnfang = nettoeinkommenJahre[0].einkommen;
                document.getElementById('nettoeinkommen-am-anfang').innerHTML = `<strong>Nettoeinkommen aktuell: ${nettoeinkommenAmAnfang.toFixed(2)} €</strong>`;

                const nettoeinkommenBeiRente = nettoeinkommenJahre[jahreBisRente].einkommen;
                document.getElementById('nettoeinkommen-bei-rente').innerHTML = `<strong>Voraussichtliches Nettoeinkommen bei Renteneintritt: ${nettoeinkommenBeiRente.toFixed(2)} €</strong><br>= Nettoeinkommen: ${nettoeinkommen.toFixed(2)} € mit jährlichem Gehaltswachstum: ${(gehaltswachstum * 100).toFixed(1)} % über ${jahreBisRente} Jahre`;

                const lebensstandardAmAnfang = lebensstandardJahre[0].lebensstandard;
                document.getElementById('lebensstandard-am-anfang').innerHTML = `<strong>Lebensstandard aktuell abzgl. wegfallender Ausgaben: ${lebensstandardAmAnfang.toFixed(2)} €</strong><br>= Nettoeinkommen: ${nettoeinkommen.toFixed(2)} € - Entfallende Ausgaben in Rente: ${entfallendeAusgaben.toFixed(2)} € - Sparrücklage: ${sparruecklage.toFixed(2)} €`;

                const lebensstandardBeiRente = nettoeinkommenBeiRente - entfallendeAusgaben - sparruecklage;
                document.getElementById('lebensstandard-bei-rente').innerHTML = `<strong>Voraussichtlicher Lebensstandard bei Renteneintritt abzgl. wegfallender Ausgaben: ${lebensstandardBeiRente.toFixed(2)} €</strong><br>= Nettoeinkommen: ${nettoeinkommenBeiRente.toFixed(2)} € - Entfallende Ausgaben in Rente: ${entfallendeAusgaben.toFixed(2)} € - Sparrücklage: ${sparruecklage.toFixed(2)} €`;

                const ctx = document.getElementById('nettoeinkommen-graph').getContext('2d');
                // Destroy existing chart instance if it exists before creating a new one
                if (window.nettoeinkommenChart) {
                    window.nettoeinkommenChart.destroy();
                }

                // Create a new chart instance and store it in a global variable
                window.nettoeinkommenChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: nettoeinkommenJahre.map(item => `Jahr ${item.jahr}`),
                        datasets: [
                            {
                                label: 'Nettoeinkommen (€)',
                                data: nettoeinkommenJahre.map(item => item.einkommen.toFixed(2)),
                                borderColor: 'blue',
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'Lebensstandard (€)',
                                data: lebensstandardJahre.map(item => item.lebensstandard.toFixed(2)),
                                borderColor: 'orange',
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'Sparrücklage (€)',
                                data: sparruecklageJahre.map(item => item.sparruecklage.toFixed(2)),
                                borderColor: 'green',
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'Entfallende Ausgaben ab Renteneintritt (€)',
                                data: entfallendeAusgabenJahre.map(item => item.entfallendeAusgaben.toFixed(2)),
                                borderColor: 'black',
                                borderWidth: 2,
                                fill: false
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Jahre bis Rente'
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Betrag (€)'
                                },
                                beginAtZero: true
                            }
                        }
                    }
                });
            });
        </script>
    </div>






    <div id="graphen-bis-rente">
        <h2>Vermögensaufbau bis Renteneintritt</h2>
        <canvas id="vermoegensaufbau-graph"></canvas>
        <div id="vermoegensaufbau-ergebnisse">
            <p id="vermoegen-am-anfang"></p>
            <p id="vermoegen-bei-rente"></p>
            <p id="netto-gespart"></p>
            <p id="zinsvermoegen"></p>
        </div>
        <script>
            document.getElementById('berechnen-button').addEventListener('click', function () {
                const kapital = parseFloat(document.getElementById('kapital').value);
                const sparruecklage = parseFloat(document.getElementById('sparruecklage').value);
                const zinssatz = parseFloat(document.getElementById('zinssatz').value) / 100;
                const jahreBisRente = parseInt(document.getElementById('jahre-bis-rente').value);

                const vermoegenJahre = [];
                const nettoGespartJahre = [];
                const zinsvermoegenJahre = [];
                let aktuellesVermoegen = kapital;
                let gesamtGespart = 0;
                let gesamtZinsen = 0;

                for (let jahr = 0; jahr <= jahreBisRente; jahr++) {
                    vermoegenJahre.push({ jahr, vermoegen: aktuellesVermoegen });
                    nettoGespartJahre.push({ jahr, gespart: gesamtGespart });
                    zinsvermoegenJahre.push({ jahr, zinsen: gesamtZinsen });

                    gesamtGespart += sparruecklage * 12;
                    const zinsen = aktuellesVermoegen * zinssatz;
                    gesamtZinsen += zinsen;
                    aktuellesVermoegen += sparruecklage * 12 + zinsen;
                }

                const vermoegenAmAnfang = vermoegenJahre[0].vermoegen;
                document.getElementById('vermoegen-am-anfang').innerHTML = `<strong>Vermögen aktuell: ${vermoegenAmAnfang.toFixed(2)} €</strong>`;

                const vermoegenBeiRente = vermoegenJahre[jahreBisRente].vermoegen;
                globalVermoegenBeiRente = vermoegenBeiRente;
                document.getElementById('vermoegen-bei-rente').innerHTML = `<strong>Voraussichtliches Vermögen bei Renteneintritt: ${vermoegenBeiRente.toFixed(2)} €</strong><br>= Startkapital: ${kapital.toFixed(2)} € + monatliche Sparrücklage: ${sparruecklage.toFixed(2)} € * jährlichem Zinssatz: ${(zinssatz * 100).toFixed(1)} % über ${jahreBisRente} Jahre`;

                const nettoGespart = sparruecklage * 12 * jahreBisRente;
                document.getElementById('netto-gespart').innerHTML = `<strong>Gespartes Vermögen (ohne Zinsen): ${nettoGespart.toFixed(2)} €</strong><br>= monatliche Sparrücklage: ${sparruecklage.toFixed(2)} € über ${jahreBisRente} Jahre`;

                const zinsvermoegen = gesamtZinsen;
                document.getElementById('zinsvermoegen').innerHTML = `<strong>Zusätzliches Vermögen durch Zinsen: ${zinsvermoegen.toFixed(2)} €</strong><br>= Summe der jährlichen Zinsen über ${jahreBisRente} Jahre, basierend auf dem jährlichen Zinssatz von ${(zinssatz * 100).toFixed(1)} % und dem Vermögen im jeweiligen Jahr`;

                const ctx = document.getElementById('vermoegensaufbau-graph').getContext('2d');
                // Destroy existing chart instance if it exists before creating a new one
                if (window.vermoegensaufbauChart) {
                    window.vermoegensaufbauChart.destroy();
                }

                // Create a new chart instance and store it in a global variable
                window.vermoegensaufbauChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: vermoegenJahre.map(item => `Jahr ${item.jahr}`),
                        datasets: [
                            {
                                label: 'Vermögen (€)',
                                data: vermoegenJahre.map(item => item.vermoegen.toFixed(2)),
                                borderColor: 'blue',
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'Netto gespart (€)',
                                data: nettoGespartJahre.map(item => item.gespart.toFixed(2)),
                                borderColor: 'green',
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'Zinsen (€)',
                                data: zinsvermoegenJahre.map(item => item.zinsen.toFixed(2)),
                                borderColor: 'purple',
                                borderWidth: 2,
                                fill: false
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Jahre bis Rente'
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Betrag (€)'
                                },
                                beginAtZero: true
                            }
                        }
                    }
                });
            });
        </script>
    </div>



    <div id="monatlicher-bedarf-ab-rente">
        <h2>Monatlicher Bedarf und Rentenlücke ab Renteneintritt bis Tod</h2>
        <canvas id="bedarf-und-rente-ab-rente-graph"></canvas>
        <div id="bedarf-und-rente-ab-rente-ergebnisse">
            <p id="lebensstandard-ab-rente"></p>
            <p id="geschaetzte-rente-ab-rente"></p>
            <p id="lebensstandard-bei-tod"></p>
            <p id="geschaetzte-rente-ab-rente"></p>
            <p id="rente-bei-tod"></p>
            <p id="delta-am-anfang-rente"></p>
            <p id="delta-bei-tod"></p>
        </div>
        <script>
            document.getElementById('berechnen-button').addEventListener('click', function () {
                const nettoeinkommen = parseFloat(document.getElementById('nettoeinkommen').value);
                const gehaltswachstum = parseFloat(document.getElementById('gehaltswachstum').value) / 100;
                const jahreBisRente = parseInt(document.getElementById('jahre-bis-rente').value);
                const entfallendeAusgaben = parseFloat(document.getElementById('entfallende-ausgaben').value);
                const sparruecklage = parseFloat(document.getElementById('sparruecklage').value);

                const nettoeinkommenBeiRente = nettoeinkommen * Math.pow(1 + gehaltswachstum, jahreBisRente);
                const lebensstandardBeiRente = nettoeinkommenBeiRente - entfallendeAusgaben - sparruecklage;
                globalLebensStandardbeiRente = lebensstandardBeiRente;
                const geschaetzteRente = parseFloat(document.getElementById('geschaetzte-rente').value);
                const rentenentwicklung = parseFloat(document.getElementById('rentenentwicklung').value) / 100;
                const inflation = parseFloat(document.getElementById('inflation').value) / 100;
                const jahreAbRente = parseInt(document.getElementById('jahre-ab-rente').value);

                const bedarfJahre = [];
                const renteJahre = [];
                const deltaJahre = [];
                let aktuellerBedarf = lebensstandardBeiRente;
                let aktuelleRente = geschaetzteRente;

                for (let jahr = 0; jahr <= jahreAbRente; jahr++) {
                    bedarfJahre.push({ jahr, bedarf: aktuellerBedarf });
                    renteJahre.push({ jahr, rente: aktuelleRente });
                    deltaJahre.push({ jahr, delta: aktuellerBedarf - aktuelleRente });
                    aktuellerBedarf += aktuellerBedarf * inflation;
                    aktuelleRente += aktuelleRente * rentenentwicklung;
                }
                
                document.getElementById('lebensstandard-ab-rente').innerHTML = `<strong>Voraussichtlicher Lebensstandard bei Renteneintritt: ${lebensstandardBeiRente.toFixed(2)} €</strong><br>= Nettoeinkommen bei Renteneintritt: ${nettoeinkommenBeiRente.toFixed(2)} € - entfallende Ausgaben: ${entfallendeAusgaben.toFixed(2)} € - Sparrücklage: ${sparruecklage.toFixed(2)} €`;

                const lebensstandardBeiTod = bedarfJahre[jahreAbRente].bedarf;
                document.getElementById('lebensstandard-bei-tod').innerHTML = `<strong>Voraussichtlicher Lebensstandard bei Tod: ${lebensstandardBeiTod.toFixed(2)} €</strong><br>= Lebensstandard bei Renteneintritt: ${lebensstandardBeiRente.toFixed(2)} € * Inflation von ${(inflation * 100).toFixed(1)} % pro Jahr über ${jahreAbRente} Jahre`;

                document.getElementById('geschaetzte-rente-ab-rente').innerHTML = `<strong>Geschätzte Rente bei Renteneintritt: ${geschaetzteRente.toFixed(2)} €</strong>`;

                const renteBeiTod = renteJahre[jahreAbRente].rente;
                document.getElementById('rente-bei-tod').innerHTML = `<strong>Voraussichtliche Rente bei Tod: ${renteBeiTod.toFixed(2)} €</strong><br>= Rentenentwicklung von ${(rentenentwicklung * 100).toFixed(1)} % pro Jahr über ${jahreAbRente} Jahre`;
                
                const deltaAmAnfang = lebensstandardBeiRente - geschaetzteRente;
                document.getElementById('delta-am-anfang-rente').innerHTML = `<strong>Rentenlücke zu Beginn der Rente: ${deltaAmAnfang.toFixed(2)} €</strong><br>= Lebensstandard bei Renteneintritt: ${lebensstandardBeiRente.toFixed(2)} € - Geschätzte Rente: ${geschaetzteRente.toFixed(2)} €`;
                                
                const deltaBeiTod = deltaJahre[jahreAbRente].delta;
                document.getElementById('delta-bei-tod').innerHTML = `<strong>Rentenlücke bei Tod: ${deltaBeiTod.toFixed(2)} €</strong><br>= Lebensstandard bei Tod: ${lebensstandardBeiTod.toFixed(2)} € - Rente bei Tod: ${renteBeiTod.toFixed(2)} €`;

                const ctx = document.getElementById('bedarf-und-rente-ab-rente-graph').getContext('2d');
                // Destroy existing chart instance if it exists before creating a new one
                if (window.bedarfUndRenteChart) {
                    window.bedarfUndRenteChart.destroy();
                }

                // Create a new chart instance and store it in a global variable
                window.bedarfUndRenteChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: bedarfJahre.map(item => `Jahr ${item.jahr}`),
                        datasets: [
                            {
                                label: 'Lebensstandard ab Renteneintritt (€)',
                                data: bedarfJahre.map(item => item.bedarf),
                                borderColor: 'orange',
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'Geschätzte Rente (€)',
                                data: renteJahre.map(item => item.rente),
                                borderColor: 'blue',
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'Delta (= Lebensstandard - Rente) (€)',
                                data: deltaJahre.map(item => item.delta),
                                borderColor: 'red',
                                borderWidth: 2,
                                fill: false
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Jahre bis zum Tod'
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Betrag (€)'
                                },
                                beginAtZero: true
                            }
                        }
                    }
                });
                
            });
        </script>
    </div>
    




    <div id="vermoegensentwicklung-ab-rente">
        <h2>Vermögensentwicklung ab Renteneintritt bis Tod</h2>
        <canvas id="vermoegensentwicklung-ab-rente-graph"></canvas>
        <div id="vermoegensentwicklung-ab-rente-ergebnisse">
            <p id="vermoegen-am-anfang-rente-ohne-zusatz"></p>
            <p id="zusatzvermoegen-am-anfang-rente"></p>
            <p id="vermoegen-am-anfang-rente"></p>
            <p id="vermoegen-bei-tod"></p>
            <p id="vermoegen-ohne-entnahme-bei-tod"></p>
            <p id="entnommenes-vermoegen"></p>
            <p id="delta-pro-jahr"></p>
        </div>
        <script>
            document.getElementById('berechnen-button').addEventListener('click', function () {
                const vermoegenBeiRente = globalVermoegenBeiRente;
                const zusatzvermoegen = parseFloat(document.getElementById('zusatzvermoegen').value);
                const vermoegenBeiRenteMitZusatz = vermoegenBeiRente + zusatzvermoegen;
                const lebensstandardBeiRente = globalLebensStandardbeiRente;
                const geschaetzteRente = parseFloat(document.getElementById('geschaetzte-rente').value);
                const rentenentwicklung = parseFloat(document.getElementById('rentenentwicklung').value) / 100;
                const inflation = parseFloat(document.getElementById('inflation').value) / 100;
                const zinssatz = parseFloat(document.getElementById('zinssatz').value) / 100;
                const jahreAbRente = parseInt(document.getElementById('jahre-ab-rente').value);

                console.log('Vermögen bei Rente:', vermoegenBeiRenteMitZusatz);
                console.log('Lebensstandard bei Rente:', lebensstandardBeiRente);
                console.log('Geschätzte Rente:', geschaetzteRente);
                console.log('Rentenentwicklung (%):', rentenentwicklung * 100);
                console.log('Inflation (%):', inflation * 100);
                console.log('Zinssatz (%):', zinssatz * 100);
                console.log('Jahre ab Rente:', jahreAbRente);
                
                const vermoegenJahre = [];
                const vermoegenOhneEntnahmeJahre = [];
                const entnommenesVermoegenJahre = [];
                const deltaJahre = [];
                let aktuellesVermoegen = vermoegenBeiRenteMitZusatz;
                let vermoegenOhneEntnahme = vermoegenBeiRenteMitZusatz;
                let gesamtEntnommen = 0;
                let aktuellerBedarf = lebensstandardBeiRente;
                let aktuelleRente = geschaetzteRente;

                for (let jahr = 0; jahr <= jahreAbRente; jahr++) {
                    const delta = aktuellerBedarf - aktuelleRente;
                    console.log('delta:', delta);
                    const entnommen = delta * 12;
                    gesamtEntnommen += entnommen;
                    const aktuellesVermoegen_neu = aktuellesVermoegen - entnommen + (aktuellesVermoegen * zinssatz);
                    aktuellesVermoegen = aktuellesVermoegen_neu;
                    vermoegenOhneEntnahme += vermoegenOhneEntnahme * zinssatz;

                    vermoegenJahre.push({ jahr, vermoegen: aktuellesVermoegen });
                    vermoegenOhneEntnahmeJahre.push({ jahr, vermoegenohne: vermoegenOhneEntnahme });
                    entnommenesVermoegenJahre.push({ jahr, entnommen: gesamtEntnommen });
                    deltaJahre.push({ jahr, delta: delta * 12 });

                    aktuellerBedarf += aktuellerBedarf * inflation;
                    aktuelleRente += aktuelleRente * rentenentwicklung;
                }

                document.getElementById('vermoegen-am-anfang-rente-ohne-zusatz').innerHTML += `<strong>Vermögen bei Renteneintritt (ohne Zusatzvermögen): ${vermoegenBeiRente.toFixed(2)} €</strong>`;
                
                document.getElementById('zusatzvermoegen-am-anfang-rente').innerHTML += `<strong>Zusatzvermögen zum Renteneintritt: ${zusatzvermoegen.toFixed(2)} €</strong>`;
                
                document.getElementById('vermoegen-am-anfang-rente').innerHTML = `<strong>Gesamtvermögen bei Renteneintritt: ${vermoegenJahre[0].vermoegen.toFixed(2)} €</strong>`;
                
                document.getElementById('vermoegen-bei-tod').innerHTML = `<strong>Vermögen bei Tod mit Entnahme: ${vermoegenJahre[jahreAbRente].vermoegen.toFixed(2)} €</strong><br>= Vermögen bei Renteneintritt: ${vermoegenBeiRenteMitZusatz.toFixed(2)} € - jährlich entnommenes Vermögen + Zinsen auf verbleibendes Vermögen über ${jahreAbRente} Jahre mit einem Zinssatz von ${(zinssatz * 100).toFixed(1)} %`;
                
                document.getElementById('vermoegen-ohne-entnahme-bei-tod').innerHTML = `<strong>Vermögen bei Tod ohne Entnahme: ${vermoegenOhneEntnahmeJahre[jahreAbRente].vermoegenohne.toFixed(2)} €</strong><br>= Vermögen bei Renteneintritt: ${vermoegenBeiRenteMitZusatz.toFixed(2)} € * jährliche Zinsen von ${(zinssatz * 100).toFixed(1)} % über ${jahreAbRente} Jahre, ohne Entnahmen`;
                
                document.getElementById('entnommenes-vermoegen').innerHTML = `<strong>Bis zum Tod entnommenes Vermögen: ${gesamtEntnommen.toFixed(2)} €</strong><br>= Summe der jährlichen Entnahmen über ${jahreAbRente} Jahre, basierend auf dem jährlichen Delta zwischen Lebensstandard und geschätzter Rente`;
                
                const ctx = document.getElementById('vermoegensentwicklung-ab-rente-graph').getContext('2d');
                if (window.vermoegensentwicklungChart) {
                    window.vermoegensentwicklungChart.destroy();
                }

                window.vermoegensentwicklungChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: vermoegenJahre.map(item => `Jahr ${item.jahr}`),
                        datasets: [
                            {
                                label: 'Vermögen (€)',
                                data: vermoegenJahre.map(item => item.vermoegen.toFixed(2)),
                                borderColor: 'blue',
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'Vermögen ohne Entnahme (€)',
                                data: vermoegenOhneEntnahmeJahre.map(item => item.vermoegenohne.toFixed(2)),
                                borderColor: 'green',
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'Entnommenes Vermögen insgesamt (€)',
                                data: entnommenesVermoegenJahre.map(item => item.entnommen.toFixed(2)),
                                borderColor: 'orange',
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'Entnahme pro Jahr (€)',
                                data: deltaJahre.map(item => item.delta.toFixed(2)),
                                borderColor: 'red',
                                borderWidth: 2,
                                fill: false
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Jahre bis zum Tod'
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Betrag (€)'
                                },
                                beginAtZero: true
                            }
                        }
                    }
                });
            });
        </script>
    </div>

    <div>
        <br>
        <button onclick="location.href='index.html'">Zurück zur Übersicht</button>
        <br>
        <p><strong>Haftungsausschluss:</strong> Die auf dieser Webseite bereitgestellten Informationen dienen ausschließlich allgemeinen Informationszwecken und stellen keine Finanz-, Anlage- oder sonstige Beratung dar. Es wird keine Gewähr für die Richtigkeit, Vollständigkeit oder Aktualität der Inhalte übernommen. Jegliche Nutzung der bereitgestellten Informationen erfolgt auf eigenes Risiko.</p>
        <br>
        <p>© 2025 - Entwickelt von bossek82</p>
    </div>
</body>
</html>
